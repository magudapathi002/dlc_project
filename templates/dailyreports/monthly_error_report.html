{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Monthly ERROR Reports</title>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    * {
      box-sizing: border-box;
    }

    @keyframes pageFadeIn {
      from { opacity: 0; transform: translateY(4px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-page-fade {
      animation: pageFadeIn 300ms ease both;
    }

    @keyframes rowReveal {
      from { opacity: 0; transform: translateY(3px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .row-reveal {
      animation: rowReveal 220ms ease both;
    }
  </style>

  <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>

<body class="bg-gray-100 text-gray-800 animate-page-fade h-screen overflow-hidden">

{% include "partials/navbar.html" %}

<div class="min-h-[calc(100vh-64px)] px-2 overflow-hidden">

  <div class="flex h-full gap-3 overflow-hidden">

    <!-- Sidebar -->
    <aside class="w-10 hidden lg:block overflow-hidden">
      {% include "partials/sidebar.html" %}
    </aside>

    <!-- ðŸ”½ WIDTH CONTROL WRAPPER -->
    <div class="flex-1 flex justify-center overflow-hidden">

      <!-- Main -->
      <main class="bg-white shadow rounded border flex flex-col min-h-0 overflow-hidden w-full max-w-[90%]">

        <!-- Header + Filters -->
        <div class="px-3 py-2 border-b flex items-center justify-between shrink-0">
          <div>
            <h1 class="text-sm font-semibold">Monthly ERROR Reports</h1>
            <p class="text-[10px] text-gray-500 uppercase">Select month & year</p>
          </div>

          <form method="get" class="flex items-center gap-2 text-xs">
            <select name="month" class="px-1 py-0.5 border rounded">
              <option value="">Month</option>
              {% for m in months %}
                <option value="{{ m.value }}" {% if m.value == selected_month %}selected{% endif %}>
                  {{ m.label }}
                </option>
              {% endfor %}
            </select>

            <select name="year" class="px-1 py-0.5 border rounded">
              <option value="">Year</option>
              {% for y in years %}
                <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>
                  {{ y }}
                </option>
              {% endfor %}
            </select>

            <button type="submit"
                    class="px-3 py-1 bg-blue-600 text-white rounded font-semibold">
              VIEW
            </button>

            <a href="?month={{ selected_month }}&year={{ selected_year }}"
               class="px-2 py-1 border rounded bg-white">
              Excel
            </a>

            <a href=""
               class="px-2 py-1 border rounded bg-white">
              Refresh
            </a>
          </form>
        </div>

        <!-- Table -->
        <div class="flex-1 p-1 overflow-hidden">

          <div class="border rounded text-[9.5px] overflow-hidden">

            <div class="bg-green-700 text-white grid grid-cols-5">
              <div class="px-1  py-[2px]">Date</div>
              <div class="px-1 py-[2px]">Forecast (MU)</div>
              <div class="px-1 py-[2px]">Actual (MU)</div>
              <div class="px-1 py-[2px] text-right">Abs. Dev</div>
              <div class="px-1 py-[2px] text-right">Abs. Error %</div>
            </div>

            {% for r in rows %}
            <div class="grid grid-cols-5 border-t row-reveal">
              <div class="px-1 font-bold py-[2px]">{{ r.date_display }}</div>
              <div class="px-1 font-bold py-[2px]"></div>
              <div class="px-1 font-bold py-[2px]">{{ r.actual|default_if_none:"--" }}</div>
              <div class="px-1 font-bold py-[2px] text-right"></div>
              <div class="px-1 font-bold py-[2px] text-right"></div>
            </div>
            {% endfor %}

            <div class="grid grid-cols-5 border-t bg-gray-100 font-semibold">
              <div class="px-1 py-[3px]">Total</div>
              <div></div>
              <div class="px-1 py-[3px] text-blue-700">
                {{ total_actual|default_if_none:"--" }}
              </div>
              <div></div>
              <div></div>
            </div>

          </div>
        </div>

      </main>
    </div>

  </div>
</div>

</body>
</html>
